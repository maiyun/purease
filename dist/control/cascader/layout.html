<div class="pe-cascader" :class="[propBoolean('plain')&&'pe-plain',propBoolean('disabled')&&'pe-disabled',propBoolean('search')&&'pe-search',propBoolean('clearable')&&value.length>0&&'pe-clearable']" :tabindex="!propBoolean('disabled') ? '0' : undefined" @pointerdown="open">
    <div v-if="displayText" class="pe-cascader-label">{{displayText}}</div>
    <div v-else class="pe-cascader-placeholder">{{placeholder || '\u3000'}}</div>
    <div v-if="propBoolean('clearable') && value.length > 0" class="pe-cascader-clear" @pointerdown="clear"></div>
    <div class="pe-cascader-arrow"></div>
    <div class="pe-pop" ref="pop">
        <pe-text v-if="propBoolean('search')" v-model="searchValue" :placeholder="l('search')" plain class="pe-cascader-search"></pe-text>
        <!-- 搜索结果 -->
        <div v-if="searchValue" class="pe-cascader-search-results">
            <div v-if="searchResults.length === 0" class="pe-cascader-empty">{{l('noMatch')}}</div>
            <div v-else v-for="result of searchResults" class="pe-cascader-search-item" @click="selectSearchResult(result)">
                {{result.pathLabels.join(separator)}}
            </div>
        </div>
        <!-- 级联面板 -->
        <div v-else class="pe-cascader-panel">
            <div v-for="(levelOptions, level) of expandedLevels" :key="level" class="pe-cascader-menu">
                <div v-if="levelOptions.length === 0" class="pe-cascader-empty">{{l('empty')}}</div>
                <div v-else v-for="(option, index) of levelOptions"
                    :key="option.value ?? option.label ?? index"
                    class="pe-cascader-item"
                    :class="[selectedIndices[level] === index && 'pe-selected', option.disabled && 'pe-disabled', (option.children && option.children.length > 0) || (lazy && option.leaf === false) ? 'pe-has-children' : '', loadingOptions[option.value ?? option.label ?? ''] && 'pe-loading']"
                    @click="selectOption(level, index, option)"
                    @mouseenter="hoverOption(level, index, option)"
                    @mouseleave="leaveOption">
                    <span class="pe-cascader-item-label">{{option.label || option.value}}</span>
                    <span v-if="loadingOptions[option.value ?? option.label ?? '']" class="pe-cascader-item-loading"></span>
                    <span v-else-if="(option.children && option.children.length > 0) || (lazy && option.leaf === false)" class="pe-cascader-item-arrow"></span>
                </div>
            </div>
        </div>
    </div>
</div>
